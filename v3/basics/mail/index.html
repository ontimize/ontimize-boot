<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.20.2 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Mail System - Ontimize Boot</title>
<meta name="description" content="">


  <meta name="author" content="Imatia Innovation, S.L.">
  


<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Ontimize Boot">
<meta property="og:title" content="Mail System">
<meta property="og:url" content="https://ontimize.github.io/ontimize-boot/v3/basics/mail/">


  <meta property="og:description" content="">











  

  


<link rel="canonical" href="https://ontimize.github.io/ontimize-boot/v3/basics/mail/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Imatia Innovation, S.L",
      "url": "https://ontimize.github.io/ontimize-boot/v3/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/ontimize-boot/v3/feed.xml" type="application/atom+xml" rel="alternate" title="Ontimize Boot Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>


<!-- For all browsers -->
<link rel="stylesheet" href="/ontimize-boot/v3/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
<link rel="stylesheet" href="/ontimize-boot/v3/assets/css/jstreestyle.css"/>

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="180x180" href="/ontimize-boot/v3/assets/images/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/ontimize-boot/v3/assets/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/ontimize-boot/v3/assets/images/favicon-16x16.png">
<link rel="mask-icon" href="/ontimize-boot/v3/assets/images/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="/ontimize-boot/v3/assets/images/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/ontimize-boot/v3/assets/images/browserconfig.xml">
<meta name="theme-color" content="#ffffff">

<!-- end custom head snippets -->
  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/ontimize-boot/v3/"><img src="/ontimize-boot/v3/assets/images/logo-ontimize.png" alt=""></a>
        
        <a class="site-title" href="/ontimize-boot/v3/">
           
          
        </a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="https://ontimize.github.io/docs/v3/">Ontimize Docs</a>
            </li>
          <li class="masthead__menu-item">
            <select class="masthead__menu-item-combo" onchange="window.location = this.options[this.selectedIndex].value">
            
              <option value="https://ontimize.github.io/ontimize-boot/v3" selected>3.x.x</option>
            
              <option value="https://ontimize.github.io/ontimize-boot">1.x.x</option>
            
            </select>
          </li>
          
        </ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="https://ontimize.github.io/ontimize-boot/v3/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1">
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/ontimize-boot/v3/basics" itemprop="item"><span itemprop="name">Basics</span></a>
          <meta itemprop="position" content="2">
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">Mail System</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Mail System">
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Mail System
</h1>
          


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fas fa-file-alt"></i> Table of Contents</h4></header>
              <ul class="toc__menu">
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#prerequisites">Prerequisites</a></li>
  <li>
<a href="#configuring-email-service-with-ontimize-boot">Configuring email service with Ontimize Boot</a>
    <ul>
      <li><a href="#db-configuration">DB configuration</a></li>
      <li><a href="#adding-dependencies">Adding dependencies</a></li>
      <li><a href="#server-configuration">Server Configuration</a></li>
      <li><a href="#creation-of-dao-files">Creation of DAO files</a></li>
      <li><a href="#implementation-in-an-existing-service">Implementation in an existing service</a></li>
    </ul>
  </li>
  <li>
<a href="#checking-the-sending-of-mails">Checking the sending of mails</a>
    <ul>
      <li><a href="#use-rest-request">Use REST request</a></li>
    </ul>
  </li>
</ul>

            </nav>
          </aside>
        
        <h2 id="introduction">Introduction</h2>

<p>Ontimize Boot is a framework that allows you to simplify the configuration of a project made with Ontimize EE, in a fast and efficient way. The email system allows you to send mail from the server with a simple configuration.</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>There are 2 options to follow this tutorial, clone the repository with the initial state and follow the tutorial step by step, or download the final example and see which files are new and which have been updated.</p>

<div class="multiColumnRow multiColumnRowJustify">
  <div class="multiColumn multiColumnGrow">
  <p><strong>Initial project</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/$ git clone https://github.com/ontimize/ontimize-examples
/ontimize-examples$ cd ontimize-examples
/ontimize-examples$ git checkout boot-mail-3.x.x-initial
</code></pre></div></div>

   
</div>
<div class="verticalDivider"></div>
<div class="multiColumn multiColumnGrow">

  <p><strong>Final example</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/$ git clone https://github.com/ontimize/ontimize-examples
/ontimize-examples$ cd ontimize-examples
/ontimize-examples$ git checkout boot-mail-3.x.x
</code></pre></div></div>



  </div>
  </div>

<h2 id="configuring-email-service-with-ontimize-boot">Configuring email service with Ontimize Boot</h2>

<p>In this complete tutorial, we are going to create a backend for an application from scratch, including the database with different tables, configuring the server, creating the necessary <strong>DAO</strong> files and implementing the service. 
At the end of the tutorial, we will even be testing that our mailing system is fully operational and functional.</p>

<h3 id="db-configuration">DB configuration</h3>

<p>If the configuration table does not exist in the DB, it can be created with the following command:</p>

<p><strong>Sentencia SQL (HSQL)</strong></p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
</pre></td>
<td class="code"><pre><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">TSETTING</span><span class="p">(</span><span class="n">ID_SETTING</span> <span class="nb">INTEGER</span> <span class="k">GENERATED</span> <span class="k">BY</span> <span class="k">DEFAULT</span> <span class="k">AS</span> <span class="k">IDENTITY</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span><span class="n">SETTING_KEY</span> <span class="n">LONGVARCHAR</span><span class="p">,</span><span class="n">SETTING_VALUE</span> <span class="n">LONGVARCHAR</span><span class="p">,</span><span class="n">SETTING_COMMENTLONGVARCHAR</span><span class="p">);</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>We fill in this table with the data that applies to each specific mail server, in this example, we will use the following:</p>

<table>
  <thead>
    <tr>
      <th>SETTING_KEY</th>
      <th>SETTING_VALUE</th>
      <th>SETTING_COMMENT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>mail_host</td>
      <td>localhost</td>
      <td>Server host</td>
    </tr>
    <tr>
      <td>mail_port</td>
      <td>2525</td>
      <td>Email server port</td>
    </tr>
    <tr>
      <td>mail_protocol</td>
      <td>smtp</td>
      <td>Mailing protocol</td>
    </tr>
    <tr>
      <td>mail_user</td>
      <td>my.mail@example.com</td>
      <td>User for sending</td>
    </tr>
    <tr>
      <td>mail_password</td>
      <td>my_password</td>
      <td>Mail server password</td>
    </tr>
    <tr>
      <td>mail_encoding</td>
      <td>UTF-8</td>
      <td>Encoding of mails</td>
    </tr>
    <tr>
      <td>mail_properties</td>
      <td>mail.smtp.auth:true; mail.smtp.starttls.enable:true;</td>
      <td>Mail properties</td>
    </tr>
  </tbody>
</table>

<p><strong>Sentencia SQL (HSQL)</strong></p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td>
<td class="code"><pre><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TSETTING</span> <span class="p">(</span><span class="n">SETTING_KEY</span><span class="p">,</span> <span class="n">SETTING_VALUE</span><span class="p">,</span> <span class="n">SETTING_COMMENT</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'mail_host'</span><span class="p">,</span> <span class="s1">'localhost'</span><span class="p">,</span> <span class="s1">'Server host'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TSETTING</span> <span class="p">(</span><span class="n">SETTING_KEY</span><span class="p">,</span> <span class="n">SETTING_VALUE</span><span class="p">,</span> <span class="n">SETTING_COMMENT</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'mail_port'</span><span class="p">,</span> <span class="s1">'2525'</span><span class="p">,</span> <span class="s1">'Email server port'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TSETTING</span> <span class="p">(</span><span class="n">SETTING_KEY</span><span class="p">,</span> <span class="n">SETTING_VALUE</span><span class="p">,</span> <span class="n">SETTING_COMMENT</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'mail_protocol'</span><span class="p">,</span> <span class="s1">'smtp'</span><span class="p">,</span> <span class="s1">'Mailing protocol'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TSETTING</span> <span class="p">(</span><span class="n">SETTING_KEY</span><span class="p">,</span> <span class="n">SETTING_VALUE</span><span class="p">,</span> <span class="n">SETTING_COMMENT</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'mail_user'</span><span class="p">,</span> <span class="s1">'my.mail@example.com'</span><span class="p">,</span> <span class="s1">'User for sending'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TSETTING</span> <span class="p">(</span><span class="n">SETTING_KEY</span><span class="p">,</span> <span class="n">SETTING_VALUE</span><span class="p">,</span> <span class="n">SETTING_COMMENT</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'mail_password'</span><span class="p">,</span> <span class="s1">'my_password'</span><span class="p">,</span> <span class="s1">'Mail server password'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TSETTING</span> <span class="p">(</span><span class="n">SETTING_KEY</span><span class="p">,</span> <span class="n">SETTING_VALUE</span><span class="p">,</span> <span class="n">SETTING_COMMENT</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'mail_encoding'</span><span class="p">,</span> <span class="s1">'UTF-8'</span><span class="p">,</span> <span class="s1">'Encoding of mails'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TSETTING</span> <span class="p">(</span><span class="n">SETTING_KEY</span><span class="p">,</span> <span class="n">SETTING_VALUE</span><span class="p">,</span> <span class="n">SETTING_COMMENT</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'mail_properties'</span><span class="p">,</span> <span class="s1">'mail.smtp.auth:true;mail.smtp.starttls.enable:true;'</span><span class="p">,</span> <span class="s1">'Mail properties'</span><span class="p">);</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>The implementation interface contains multiple methods, to which we must give permissions, if our application has permissions:</p>

<p><strong>Sentencia SQL (HSQL)</strong></p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
</pre></td>
<td class="code"><pre><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TSERVER_PERMISSION</span> <span class="p">(</span><span class="n">PERMISSION_NAME</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'com.ontimize.jee.server.services.mail.IMailServiceServer/sendMail'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TSERVER_PERMISSION</span> <span class="p">(</span><span class="n">PERMISSION_NAME</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'com.ontimize.jee.server.services.mail.IMailServiceServer/sendMailWithoutAttach'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TROLE_SERVER_PERMISSION</span> <span class="p">(</span><span class="n">ID_ROLENAME</span><span class="p">,</span> <span class="n">ID_SERVER_PERMISSION</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">((</span><span class="k">SELECT</span> <span class="n">ID_ROLENAME</span> <span class="k">FROM</span> <span class="n">TROLE</span> <span class="k">WHERE</span> <span class="n">ROLENAME</span><span class="o">=</span><span class="s1">'admin'</span><span class="p">),</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">ID_SERVER_PERMISSION</span> <span class="k">FROM</span> <span class="n">TSERVER_PERMISSION</span> <span class="k">WHERE</span> <span class="n">PERMISSION_NAME</span><span class="o">=</span><span class="s1">'com.ontimize.jee.server.services.mail.IMailServiceServer/sendMail'</span><span class="p">));</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TROLE_SERVER_PERMISSION</span> <span class="p">(</span><span class="n">ID_ROLENAME</span><span class="p">,</span> <span class="n">ID_SERVER_PERMISSION</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">((</span><span class="k">SELECT</span> <span class="n">ID_ROLENAME</span> <span class="k">FROM</span> <span class="n">TROLE</span> <span class="k">WHERE</span> <span class="n">ROLENAME</span><span class="o">=</span><span class="s1">'admin'</span><span class="p">),</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">ID_SERVER_PERMISSION</span> <span class="k">FROM</span> <span class="n">TSERVER_PERMISSION</span> <span class="k">WHERE</span> <span class="n">PERMISSION_NAME</span><span class="o">=</span><span class="s1">'com.ontimize.jee.server.services.mail.IMailServiceServer/sendMailWithoutAttach'</span><span class="p">));</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<h3 id="adding-dependencies">Adding dependencies</h3>

<p>Now we need to add the correct dependency in the correct <strong>pom.xml</strong>:</p>

<div class="multiColumnRow">
  <div class="multiColumn jstreeloader">
 <ul>
  <li data-jstree='{"opened":true, "icon":"fas fa-folder-open"}'>
  ontimize-examples
  <ul>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    projectwiki-api
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            com
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              ontimize
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                projectwiki
                <ul>
                  <li data-jstree='{"icon":"fas fa-folder-open"}'>
                  api
                  <ul>
                    <li data-jstree='{"icon":"fas fa-folder-open"}'>
                    core
                    <ul>
                      <li data-jstree='{"icon":"fas fa-folder-open"}'>
                      service
                      <ul>
                        <li data-jstree='{"icon":"fas fa-file"}'>ICandidateService.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>IUserService.java</li>
                      </ul>
                      </li>
                    </ul>
                    </li>
                  </ul>
                  </li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    projectwiki-boot
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            com
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              ontimize
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                projectwiki
                <ul>
                  <li data-jstree='{"icon":"fas fa-file"}'>ServerApplication.java</li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          resources
          <ul>
            <li data-jstree='{"icon":"fas fa-file"}'>application.yml</li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"selected":true,"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    projectwiki-model
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          db
          <ul>
            <li data-jstree='{"icon":"fas fa-file"}'>templateDB.properties</li>
            <li data-jstree='{"icon":"fas fa-file"}'>templateDB.txt</li>
          </ul>
          </li>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            com
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              ontimize
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                projectwiki
                <ul>
                  <li data-jstree='{"icon":"fas fa-folder-open"}'>
                  model
                  <ul>
                    <li data-jstree='{"icon":"fas fa-folder-open"}'>
                    core
                    <ul>
                      <li data-jstree='{"icon":"fas fa-folder-open"}'>
                      dao
                      <ul>
                        <li data-jstree='{"icon":"fas fa-file"}'>CandidateDao.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>UserDao.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>UserRoleDao.java</li>
                      </ul>
                      </li>
                      <li data-jstree='{"icon":"fas fa-folder-open"}'>
                      service
                      <ul>
                        <li data-jstree='{"icon":"fas fa-file"}'>CandidateService.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>UserService.java</li>
                      </ul>
                      </li>
                    </ul>
                    </li>
                  </ul>
                  </li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          resources
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            dao
            <ul>
              <li data-jstree='{"icon":"fas fa-file"}'>CandidateDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>placeholders.properties</li>
              <li data-jstree='{"icon":"fas fa-file"}'>RoleDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>RoleServerPermissionDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>ServerPermissionDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>UserDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>UserRoleDao.xml</li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    projectwiki-ws
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            com
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              ontimize
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                projectwiki
                <ul>
                  <li data-jstree='{"icon":"fas fa-folder-open"}'>
                  ws
                  <ul>
                    <li data-jstree='{"icon":"fas fa-folder-open"}'>
                    core
                    <ul>
                      <li data-jstree='{"icon":"fas fa-folder-open"}'>
                      rest
                      <ul>
                        <li data-jstree='{"icon":"fas fa-file"}'>CandidateRestController.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>MainRestController.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>TestRestController.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>UserRestController.java</li>
                      </ul>
                      </li>
                    </ul>
                    </li>
                  </ul>
                  </li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-file"}'>.gitignore</li>
    <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    <li data-jstree='{"icon":"fas fa-file"}'>README.md</li>
  </ul>
  </li>
</ul>
  </div>
  <div class="multiColumn multiColumnGrow">


<figure class="highlight"><pre><code class="language-xml" data-lang="xml">...
<span class="nt">&lt;dependencies&gt;</span>
...	
  <span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-mail<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;/dependency&gt;</span>
...
<span class="nt">&lt;/dependencies&gt;</span>
...</code></pre></figure>

  </div>
</div>

<h3 id="server-configuration">Server Configuration</h3>

<p>To configure this service, a new configuration fragment shall be added to the <strong>application.yml</strong> file.</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td>
<td class="code"><pre><span class="na">ontimize</span><span class="pi">:</span>
   <span class="na">mail</span><span class="pi">:</span>
      <span class="na">ref-repository</span><span class="pi">:</span> <span class="s">OCSettingsDao</span>
      <span class="na">filter-column-name</span><span class="pi">:</span> <span class="s">SETTING_KEY</span>
      <span class="na">value-column-name</span><span class="pi">:</span> <span class="s">SETTING_VALUE</span>
      <span class="na">query-id</span><span class="pi">:</span> <span class="s">default</span>
      <span class="na">filter-column-value-encoding</span><span class="pi">:</span> <span class="s">mail_encoding</span>
      <span class="na">filter-column-value-host</span><span class="pi">:</span> <span class="s">mail_host</span>
      <span class="na">filter-column-value-port</span><span class="pi">:</span> <span class="s">mail_port</span>
      <span class="na">filter-column-value-protocol</span><span class="pi">:</span> <span class="s">mail_protocol</span>
      <span class="na">filter-column-value-user</span><span class="pi">:</span> <span class="s">mail_user</span>
      <span class="na">filter-column-value-password</span><span class="pi">:</span> <span class="s">mail_password</span>
      <span class="na">filter-column-value-java-mail-properties</span><span class="pi">:</span> <span class="s">mail_properties</span>
      <span class="na">engine</span><span class="pi">:</span> <span class="s">default</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>This configuration indicates the keys and values to be stored in the database. The database table is the one corresponding to the bean described in the <strong>refRepository: OCSettingsDao</strong> attribute (in this case, OCSettingsDao), which can be seen in the table <code class="language-plaintext highlighter-rouge">TSETTING</code> attribute (for this example, <code class="language-plaintext highlighter-rouge">TSETTING</code>) of the *.xml configuration file of the bean (<em>OCSettingsDao.xml</em>). The keys would be stored in the <code class="language-plaintext highlighter-rouge">SETTING_KEY</code> column, the values in the <code class="language-plaintext highlighter-rouge">SETTING_VALUE</code> column and the rest of the attributes map the keys that exist in the database.</p>

<p>In addition, the packet that will be scanned to look for the implementation of the email service is indicated.</p>

<h3 id="creation-of-dao-files">Creation of DAO files</h3>

<p>Let’s create a <strong>DAO</strong> (<strong>D</strong>ata <strong>A</strong>ccess <strong>O</strong>bject) in the <code class="language-plaintext highlighter-rouge">projectwiki-model</code> module to use as a model of this database table. The <strong>DAO</strong> is composed by 2 files, a file with extension *.xml and a *.java file.</p>

<div class="multiColumnRow">
  <div class="multiColumn jstreeloader">
 <ul>
  <li data-jstree='{"opened":true, "icon":"fas fa-folder-open"}'>
  ontimize-examples
  <ul>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    projectwiki-api
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            com
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              ontimize
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                projectwiki
                <ul>
                  <li data-jstree='{"icon":"fas fa-folder-open"}'>
                  api
                  <ul>
                    <li data-jstree='{"icon":"fas fa-folder-open"}'>
                    core
                    <ul>
                      <li data-jstree='{"icon":"fas fa-folder-open"}'>
                      service
                      <ul>
                        <li data-jstree='{"icon":"fas fa-file"}'>ICandidateService.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>IUserService.java</li>
                      </ul>
                      </li>
                    </ul>
                    </li>
                  </ul>
                  </li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    projectwiki-boot
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            com
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              ontimize
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                projectwiki
                <ul>
                  <li data-jstree='{"icon":"fas fa-file"}'>ServerApplication.java</li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          resources
          <ul>
            <li data-jstree='{"icon":"fas fa-file"}'>application.yml</li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    projectwiki-model
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          db
          <ul>
            <li data-jstree='{"icon":"fas fa-file"}'>templateDB.properties</li>
            <li data-jstree='{"icon":"fas fa-file"}'>templateDB.txt</li>
          </ul>
          </li>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            com
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              ontimize
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                projectwiki
                <ul>
                  <li data-jstree='{"icon":"fas fa-folder-open"}'>
                  model
                  <ul>
                    <li data-jstree='{"icon":"fas fa-folder-open"}'>
                    core
                    <ul>
                      <li data-jstree='{"icon":"fas fa-folder-open"}'>
                      dao
                      <ul>
                        <li data-jstree='{"icon":"fas fa-file"}'>CandidateDao.java</li>
                        <li data-jstree='{"selected":true,"icon":"fas fa-file"}'>OCSettingsDao.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>UserDao.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>UserRoleDao.java</li>
                      </ul>
                      </li>
                      <li data-jstree='{"icon":"fas fa-folder-open"}'>
                      service
                      <ul>
                        <li data-jstree='{"icon":"fas fa-file"}'>CandidateService.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>UserService.java</li>
                      </ul>
                      </li>
                    </ul>
                    </li>
                  </ul>
                  </li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          resources
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            dao
            <ul>
              <li data-jstree='{"icon":"fas fa-file"}'>CandidateDao.xml</li>
              <li data-jstree='{"selected":true,"icon":"fas fa-file"}'>OCSettingsDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>placeholders.properties</li>
              <li data-jstree='{"icon":"fas fa-file"}'>RoleDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>RoleServerPermissionDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>ServerPermissionDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>UserDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>UserRoleDao.xml</li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    projectwiki-ws
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            com
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              ontimize
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                projectwiki
                <ul>
                  <li data-jstree='{"icon":"fas fa-folder-open"}'>
                  ws
                  <ul>
                    <li data-jstree='{"icon":"fas fa-folder-open"}'>
                    core
                    <ul>
                      <li data-jstree='{"icon":"fas fa-folder-open"}'>
                      rest
                      <ul>
                        <li data-jstree='{"icon":"fas fa-file"}'>CandidateRestController.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>MainRestController.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>TestRestController.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>UserRestController.java</li>
                      </ul>
                      </li>
                    </ul>
                    </li>
                  </ul>
                  </li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-file"}'>.gitignore</li>
    <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    <li data-jstree='{"icon":"fas fa-file"}'>README.md</li>
  </ul>
  </li>
</ul>
  </div>
  <div class="multiColumn">
    <p>In our *.xml file we will indicate the database table for which <strong>DAO</strong> belongs, the data source from which we collect the information (e.g. the database connection that contains this table) and the schema to which the table belongs.</p>


    <p><strong>OCSettingsDao.xml</strong></p>
   

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td>
<td class="code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;JdbcEntitySetup</span>
    <span class="na">xmlns=</span><span class="s">"http://www.ontimize.com/schema/jdbc"</span>
    <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.ontimize.com/schema/jdbc http://www.ontimize.com/schema/jdbc/ontimize-jdbc-dao.xsd"</span>
    <span class="na">catalog=</span><span class="s">""</span> <span class="na">schema=</span><span class="s">"${mainschema}"</span> <span class="na">table=</span><span class="s">"TSETTING"</span>
    <span class="na">datasource=</span><span class="s">"mainDataSource"</span> <span class="na">sqlhandler=</span><span class="s">"dbSQLStatementHandler"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;DeleteKeys&gt;</span>
        <span class="nt">&lt;Column&gt;</span>ID_SETTING<span class="nt">&lt;/Column&gt;</span>
    <span class="nt">&lt;/DeleteKeys&gt;</span>
    <span class="nt">&lt;UpdateKeys&gt;</span>
        <span class="nt">&lt;Column&gt;</span>ID_SETTING<span class="nt">&lt;/Column&gt;</span>
    <span class="nt">&lt;/UpdateKeys&gt;</span>
    <span class="nt">&lt;GeneratedKey&gt;</span>ID_SETTING<span class="nt">&lt;/GeneratedKey&gt;</span>
<span class="nt">&lt;/JdbcEntitySetup&gt;</span>
</pre></td>
</tr></tbody></table></code></pre></figure>


    <p>In the *.java file we indicate that it is a repository whose name will be <em>OCSettingsDao</em>, through the annotation <code class="language-plaintext highlighter-rouge">@Repository</code>. With the annotation <code class="language-plaintext highlighter-rouge">@Lazy</code>, we will indicate that the load is delayed until it is completely necessary (improving in that way the performance), and the annotation <code class="language-plaintext highlighter-rouge">@ConfigurationFile</code> allows us to configure this <strong>DAO</strong> using the <strong>XML</strong> file and an additional file where some common characteristics to several <strong>DAO</strong>s can be stored. like the scheme to which they belong.</p>


    <p><strong>OCSettingsDao.java</strong></p>


<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td>
<td class="code"><pre><span class="kn">package</span> <span class="nn">com.ontimize.projectwiki.model.core.dao</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Lazy</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Repository</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.ontimize.jee.server.dao.common.ConfigurationFile</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.ontimize.jee.server.dao.jdbc.OntimizeJdbcDaoSupport</span><span class="o">;</span>

<span class="nd">@Repository</span><span class="o">(</span><span class="s">"OCSettingsDao"</span><span class="o">)</span>
<span class="nd">@Lazy</span>
<span class="nd">@ConfigurationFile</span><span class="o">(</span><span class="n">configurationFile</span> <span class="o">=</span> <span class="s">"dao/OCSettingsDao.xml"</span><span class="o">,</span> <span class="n">configurationFilePlaceholder</span> <span class="o">=</span> <span class="s">"dao/placeholders.properties"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OCSettingsDao</span> <span class="kd">extends</span> <span class="nc">OntimizeJdbcDaoSupport</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="nf">OCSettingsDao</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">();</span>
  <span class="o">}</span>

<span class="o">}</span>
</pre></td>
</tr></tbody></table></code></pre></figure>


  </div>
</div>

<h3 id="implementation-in-an-existing-service">Implementation in an existing service</h3>

<p>To use this service in another service (e.g. to send a mail when a new record is created), just add a variable of type <strong>com.ontimize.jee.common.services.mail.IMailService</strong> and annotate it with <code class="language-plaintext highlighter-rouge">@Autowired</code>.</p>

<div class="multiColumnRow">
  <div class="multiColumn jstreeloader">
 <ul>
  <li data-jstree='{"opened":true, "icon":"fas fa-folder-open"}'>
  ontimize-examples
  <ul>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    projectwiki-api
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            com
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              ontimize
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                projectwiki
                <ul>
                  <li data-jstree='{"icon":"fas fa-folder-open"}'>
                  api
                  <ul>
                    <li data-jstree='{"icon":"fas fa-folder-open"}'>
                    core
                    <ul>
                      <li data-jstree='{"icon":"fas fa-folder-open"}'>
                      service
                      <ul>
                        <li data-jstree='{"icon":"fas fa-file"}'>ICandidateService.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>IUserService.java</li>
                      </ul>
                      </li>
                    </ul>
                    </li>
                  </ul>
                  </li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    projectwiki-boot
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            com
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              ontimize
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                projectwiki
                <ul>
                  <li data-jstree='{"icon":"fas fa-file"}'>ServerApplication.java</li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          resources
          <ul>
            <li data-jstree='{"icon":"fas fa-file"}'>application.yml</li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    projectwiki-model
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          db
          <ul>
            <li data-jstree='{"icon":"fas fa-file"}'>templateDB.properties</li>
            <li data-jstree='{"icon":"fas fa-file"}'>templateDB.txt</li>
          </ul>
          </li>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            com
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              ontimize
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                projectwiki
                <ul>
                  <li data-jstree='{"icon":"fas fa-folder-open"}'>
                  model
                  <ul>
                    <li data-jstree='{"icon":"fas fa-folder-open"}'>
                    core
                    <ul>
                      <li data-jstree='{"icon":"fas fa-folder-open"}'>
                      dao
                      <ul>
                        <li data-jstree='{"icon":"fas fa-file"}'>CandidateDao.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>OCSettingsDao.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>UserDao.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>UserRoleDao.java</li>
                      </ul>
                      </li>
                      <li data-jstree='{"icon":"fas fa-folder-open"}'>
                      service
                      <ul>
                        <li data-jstree='{"selected":true,"icon":"fas fa-file"}'>CandidateService.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>UserService.java</li>
                      </ul>
                      </li>
                    </ul>
                    </li>
                  </ul>
                  </li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          resources
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            dao
            <ul>
              <li data-jstree='{"icon":"fas fa-file"}'>CandidateDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>OCSettingsDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>placeholders.properties</li>
              <li data-jstree='{"icon":"fas fa-file"}'>RoleDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>RoleServerPermissionDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>ServerPermissionDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>UserDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>UserRoleDao.xml</li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    projectwiki-ws
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            com
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              ontimize
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                projectwiki
                <ul>
                  <li data-jstree='{"icon":"fas fa-folder-open"}'>
                  ws
                  <ul>
                    <li data-jstree='{"icon":"fas fa-folder-open"}'>
                    core
                    <ul>
                      <li data-jstree='{"icon":"fas fa-folder-open"}'>
                      rest
                      <ul>
                        <li data-jstree='{"icon":"fas fa-file"}'>CandidateRestController.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>MainRestController.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>TestRestController.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>UserRestController.java</li>
                      </ul>
                      </li>
                    </ul>
                    </li>
                  </ul>
                  </li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-file"}'>.gitignore</li>
    <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    <li data-jstree='{"icon":"fas fa-file"}'>README.md</li>
  </ul>
  </li>
</ul>
  </div>
  <div class="multiColumn">


<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="o">...</span>
<span class="kn">import</span> <span class="nn">com.ontimize.jee.common.services.mail.IMailService</span><span class="o">;</span>
<span class="o">...</span>
<span class="nd">@Service</span><span class="o">(</span><span class="s">"CandidateService"</span><span class="o">)</span>
<span class="nd">@Lazy</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CandidateService</span> <span class="kd">implements</span> <span class="nc">ICandidateService</span> <span class="o">{</span>
<span class="o">...</span>
<span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">IMailService</span> <span class="n">mailService</span><span class="o">;</span>
 <span class="o">...</span>
<span class="nd">@Override</span>
<span class="kd">public</span> <span class="nc">EntityResult</span> <span class="nf">candidateInsert</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">attrMap</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">OntimizeJEERuntimeException</span> <span class="o">{</span>
	<span class="nc">EntityResult</span> <span class="n">toRet</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">daoHelper</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">candidateDao</span><span class="o">,</span> <span class="n">attrMap</span><span class="o">);</span>

	<span class="k">if</span> <span class="o">((</span><span class="n">toRet</span><span class="o">.</span><span class="na">getCode</span><span class="o">()</span> <span class="o">!=</span> <span class="nc">EntityResult</span><span class="o">.</span><span class="na">OPERATION_WRONG</span><span class="o">))</span> <span class="o">{</span>

		<span class="nc">Runnable</span> <span class="n">runnable</span> <span class="o">=</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>

		<span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">receiverList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;();</span>
		<span class="n">receiverList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"receiver@example.com"</span><span class="o">);</span>
		<span class="nc">StringBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
		<span class="n">builder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"Created new user."</span><span class="o">);</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="k">this</span><span class="o">.</span><span class="na">mailService</span><span class="o">.</span><span class="na">sendMailWithoutAttach</span><span class="o">(</span><span class="s">"my.mail@example.com"</span><span class="o">,</span> <span class="n">receiverList</span><span class="o">,</span> <span class="s">"New candidate"</span><span class="o">,</span>
				<span class="n">builder</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">OntimizeJEEException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
	<span class="o">}</span>
	<span class="o">};</span>
			
  <span class="nc">DelegatingSecurityContextRunnable</span> <span class="n">wrappedRunnable</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DelegatingSecurityContextRunnable</span><span class="o">(</span><span class="n">runnable</span><span class="o">);</span>
	  <span class="k">new</span> <span class="nf">Thread</span><span class="o">(</span><span class="n">wrappedRunnable</span><span class="o">).</span><span class="na">start</span><span class="o">();</span>
  <span class="o">}</span>

<span class="k">return</span> <span class="n">toRet</span><span class="o">;</span>
<span class="o">}</span>
 <span class="o">...</span>
  </code></pre></figure>

  </div>
</div>

<p class="notice--warning"><strong>Note:</strong> For space reasons, the entire files are not included, only the code snippets <strong>related to the tutorial</strong>. The … in the code snippets indicate that <strong>there may</strong> be unrelated code before or after them.</p>

<h2 id="checking-the-sending-of-mails">Checking the sending of mails</h2>

<p>In order to check that the created service is indeed sending mails, we will use an external service called <strong>FakeSMTP</strong>, is a <em>free</em> Fake SMTP Server with GUI for testing emails in applications easily.</p>

<p>To do this, we enter  <a href="http://nilhcem.com/FakeSMTP/download.html" target="_blank" rel="noopener noreferrer"><strong>this link</strong></a> and clone the repository it indicates into the workspace where we have our project.</p>

<p>We launch the DB and the server. Next, open a console and move to the path where <strong>FakeSMTP</strong> was downloaded:</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
</pre></td>
<td class="code"><pre><span class="s">...\FakeSMTP&gt; mvn package-Dmaven.test.skip</span>
<span class="s">...\FakeSMTP&gt; cd target</span>
<span class="s">...\FakeSMTP\target&gt; java -jar fakeSMTP-2.1-SNAPSHOT.jar -s -p 2525</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<table>
  <thead>
    <tr>
      <th>Command</th>
      <th>Meaning</th>
      <th>34</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>fakeSMTP-VERSION.jar</td>
      <td>Downloaded version.</td>
      <td> </td>
    </tr>
    <tr>
      <td>-s</td>
      <td>Launch the server.</td>
      <td> </td>
    </tr>
    <tr>
      <td>- p 2525</td>
      <td>Launch the application on the port indicated.</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>Now we can use an application like <strong>Postman</strong> to execute different REST requests to our project.</p>

<h3 id="use-rest-request">Use REST request</h3>

<p>The requests contains the following structure: <strong>localhost:33333/candidates/candidate</strong></p>

<table>
  <thead>
    <tr>
      <th>Element</th>
      <th>Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>localhost:33333</td>
      <td>Indicates the host</td>
    </tr>
    <tr>
      <td>/candidates</td>
      <td>Indicates the service to be queried</td>
    </tr>
    <tr>
      <td>/candidate</td>
      <td>Indicates the <strong>DAO</strong> that will access that service</td>
    </tr>
  </tbody>
</table>

<p>The request types can only be <strong>GET, POST, PUT, DELETE</strong>.</p>

<p>Below are examples of request for candidates (<strong>CANDIDATES</strong>).</p>

<p>The authorization used for these requests is authorization of the type <strong>BASIC</strong>.</p>

<p>In both cases, the access must be done with a user and password example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    User: demo
Password: demouser
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Request type</th>
      <th>Query</th>
      <th>URL</th>
      <th>Service method</th>
      <th>Body request</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>POST</td>
      <td>insert</td>
      <td>localhost:33333/candidates/candidate</td>
      <td>candidateInsert</td>
      <td>Example below</td>
    </tr>
  </tbody>
</table>

<p><strong>Body request:</strong></p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"PHONE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"555-444-8888"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"BIRTHDAY"</span><span class="p">:</span><span class="w"> </span><span class="mi">788224700000</span><span class="p">,</span><span class="w">
        </span><span class="nl">"SURNAME"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Wilson"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"EMAIL"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wwiilsoon@example.org"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"SPECIALTIES"</span><span class="p">:</span><span class="w"> </span><span class="s2">"C#"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"NAME"</span><span class="p">:</span><span class="w"> </span><span class="s2">"William"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"DNI"</span><span class="p">:</span><span class="w"> </span><span class="s2">"88643946Z"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"sqltypes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"SPECIALTIES"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
        </span><span class="nl">"LINKEDIN"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
        </span><span class="nl">"PHONE"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
        </span><span class="nl">"EXPERIENCE_LEVEL"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
        </span><span class="nl">"STATUS"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
        </span><span class="nl">"EMAIL"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
        </span><span class="nl">"WAGE_LEVEL"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nl">"DNI"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
        </span><span class="nl">"ID"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
        </span><span class="nl">"ORIGIN"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
        </span><span class="nl">"EDUCATION"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
        </span><span class="nl">"COMMENT"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
        </span><span class="nl">"PROFILE"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
        </span><span class="nl">"SURNAME"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
        </span><span class="nl">"NAME"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
        </span><span class="nl">"BIRTHDAY"</span><span class="p">:</span><span class="w"> </span><span class="mi">91</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
  </span></code></pre></figure>


        
      </section>

      <footer class="page__meta">
        
        


        

      </footer>

      

      
    </div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/imatiainnova" rel="noopener noreferrer" target="_blank"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/company/imatia-innovation/" rel="noopener noreferrer" target="_blank"><i class="fab fa-fw fa-linkedin-in" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://github.com/ontimize/ontimize-boot" rel="noopener noreferrer" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    <li><a href="/ontimize-boot/v3/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2021 Imatia Innovation, S.L. Powered by <a href="https://jekyllrb.com" rel="noopener noreferrer" target="_blank">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="noopener noreferrer" target="_blank">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/ontimize-boot/v3/assets/js/main.min.js"></script>











  </body>
</html>
