<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.20.2 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Security System - Ontimize Boot</title>
<meta name="description" content="">


  <meta name="author" content="Imatia Innovation, S.L.">
  


<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Ontimize Boot">
<meta property="og:title" content="Security System">
<meta property="og:url" content="https://ontimize.github.io/ontimize-boot/v1/basics/security/">


  <meta property="og:description" content="">











  

  


<link rel="canonical" href="https://ontimize.github.io/ontimize-boot/v1/basics/security/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Imatia Innovation, S.L",
      "url": "https://ontimize.github.io/ontimize-boot/v1/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/ontimize-boot/v1/feed.xml" type="application/atom+xml" rel="alternate" title="Ontimize Boot Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>


<!-- For all browsers -->
<link rel="stylesheet" href="/ontimize-boot/v1/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
<link rel="stylesheet" href="/ontimize-boot/v1/assets/css/jstreestyle.css"/>

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="180x180" href="/ontimize-boot/v1/assets/images/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/ontimize-boot/v1/assets/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/ontimize-boot/v1/assets/images/favicon-16x16.png">
<link rel="mask-icon" href="/ontimize-boot/v1/assets/images/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="/ontimize-boot/v1/assets/images/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/ontimize-boot/v1/assets/images/browserconfig.xml">
<meta name="theme-color" content="#ffffff">

<!-- end custom head snippets -->
  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/ontimize-boot/v1/"><img src="/ontimize-boot/v1/assets/images/logo-ontimize.png" alt=""></a>
        
        <a class="site-title" href="/ontimize-boot/v1/">
           
          
        </a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="https://ontimize.github.io/docs/v1/">Ontimize Docs</a>
            </li>
          <li class="masthead__menu-item">
            <select class="masthead__menu-item-combo" onchange="window.location = this.options[this.selectedIndex].value">
            
              <option value="https://ontimize.github.io/ontimize-boot/v1" selected>1.x.x</option>
            
              <option value="https://ontimize.github.io/ontimize-boot">3.x.x</option>
            
            </select>
          </li>
          
        </ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="https://ontimize.github.io/ontimize-boot/v1/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1">
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/ontimize-boot/v1/basics" itemprop="item"><span itemprop="name">Basics</span></a>
          <meta itemprop="position" content="2">
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">Security System</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Security System">
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Security System
</h1>
          


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fas fa-file-alt"></i> Table of Contents</h4></header>
              <ul class="toc__menu">
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#prerequisites">Prerequisites</a></li>
  <li>
<a href="#steps">Steps</a>
    <ul>
      <li><a href="#add-new-profile-and-user">Add new profile and user</a></li>
      <li><a href="#modify-the-service-to-add-security">Modify the service to add security</a></li>
      <li><a href="#add-permissions-for-methods">Add permissions for methods</a></li>
    </ul>
  </li>
</ul>

            </nav>
          </aside>
        
        <h1 id="introduction">Introduction</h1>
<p>Ontimize security allows you to set permissions to each role that you assign to a specific user, so that different users can access (or not) the project services and methods.</p>

<h1 id="prerequisites">Prerequisites</h1>
<p>You can follow this tutorial using your own application, although for this example we will use an application created using the archetype that can be found <a href="https://ontimize.github.io/ontimize-boot/getting_started/">on this page</a> and with a REST service.</p>

<p>There are 2 options to follow this tutorial, clone the repository with the initial state and follow the tutorial step by step, or download the final example and see which files are new and which have been updated.</p>

<div class="multiColumnRow multiColumnRowJustify">
<div class="multiColumn multiColumnGrow">
  <p><strong>Initial project</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/$ git clone https://github.com/ontimize/ontimize-examples 
/ontimize-examples$ cd ontimize-examples
/ontimize-examples$ git checkout boot-security-1.x.x-initial
</code></pre></div></div>

</div>
<div class="verticalDivider"></div>
<div class="multiColumn multiColumnGrow">

  <p><strong>Final example</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/$ git clone https://github.com/ontimize/ontimize-examples 
/ontimize-examples$ cd ontimize-examples
/ontimize-examples$ git checkout boot-security-1.x.x
</code></pre></div></div>


</div>
</div>

<p class="notice--info"><strong>Note:</strong> To simplify the code being written, three dots (â€¦) may appear in some parts of the code. This indicates that there may be previous code before and after those dots.</p>

<h1 id="steps">Steps</h1>

<h2 id="add-new-profile-and-user">Add new profile and user</h2>

<p>We will add the following elements to the database:</p>

<ul>
  <li>New user</li>
</ul>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
</pre></td>
<td class="code"><pre><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TUSER</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'candidate'</span><span class="p">,</span><span class="s1">'candidate'</span><span class="p">,</span><span class="s1">'candidate'</span><span class="p">,</span><span class="s1">'candidate'</span><span class="p">,</span><span class="k">NULL</span><span class="p">,</span><span class="s1">'99999999R'</span><span class="p">,</span><span class="k">NULL</span><span class="p">,</span><span class="s1">'2020-07-03 11:50:40.665000'</span><span class="p">,</span><span class="k">NULL</span><span class="p">)</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<ul>
  <li>New user role</li>
</ul>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
</pre></td>
<td class="code"><pre><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TROLE</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">'candidate'</span><span class="p">,</span><span class="s1">'&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;security&gt;&lt;/security&gt;'</span><span class="p">)</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<ul>
  <li>Relationship between the new user and the new role</li>
</ul>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
</pre></td>
<td class="code"><pre><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TUSER_ROLE</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">'candidate'</span><span class="p">)</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<h2 id="modify-the-service-to-add-security">Modify the service to add security</h2>

<p>In the <em>projectwiki-boot</em> module we will add the annotation <code class="language-plaintext highlighter-rouge">@EnableAspectJAutoProxy(proxyTargetClass = false)</code> to the <strong>ServerApplication.java</strong> class and to each service method the <code class="language-plaintext highlighter-rouge">@Secured({ PermissionsProviderSecured.SECURED })</code> annotation.</p>

<div class="multiColumnRow">
<div class="multiColumn jstreeloader">
<ul>
  <li data-jstree='{"opened":true, "icon":"fas fa-folder-open"}'>
  ontimize-examples
  <ul>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    projectwiki-api
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            com
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              ontimize
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                projectwiki
                <ul>
                  <li data-jstree='{"icon":"fas fa-folder-open"}'>
                  api
                  <ul>
                    <li data-jstree='{"icon":"fas fa-folder-open"}'>
                    core
                    <ul>
                      <li data-jstree='{"icon":"fas fa-folder-open"}'>
                      service
                      <ul>
                        <li data-jstree='{"icon":"fas fa-file"}'>ICandidateService.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>IUserService.java</li>
                      </ul>
                      </li>
                    </ul>
                    </li>
                  </ul>
                  </li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    projectwiki-boot
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            com
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              ontimize
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                projectwiki
                <ul>
                  <li data-jstree='{"selected": true, "icon":"fas fa-file"}'>ServerApplication.java</li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          resources
          <ul>
            <li data-jstree='{"icon":"fas fa-file"}'>application.yml</li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    projectwiki-model
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          db
          <ul>
            <li data-jstree='{"icon":"fas fa-file"}'>templateDB.properties</li>
            <li data-jstree='{"icon":"fas fa-file"}'>templateDB.txt</li>
          </ul>
          </li>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            com
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              ontimize
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                projectwiki
                <ul>
                  <li data-jstree='{"icon":"fas fa-folder-open"}'>
                  model
                  <ul>
                    <li data-jstree='{"icon":"fas fa-folder-open"}'>
                    core
                    <ul>
                      <li data-jstree='{"icon":"fas fa-folder-open"}'>
                      dao
                      <ul>
                        <li data-jstree='{"icon":"fas fa-file"}'>CandidateDao.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>UserDao.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>UserRoleDao.java</li>
                      </ul>
                      </li>
                      <li data-jstree='{"icon":"fas fa-folder-open"}'>
                      service
                      <ul>
                        <li data-jstree='{"selected": true, "icon":"fas fa-file"}'>CandidateService.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>UserService.java</li>
                      </ul>
                      </li>
                    </ul>
                    </li>
                  </ul>
                  </li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          resources
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            dao
            <ul>
              <li data-jstree='{"icon":"fas fa-file"}'>CandidateDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>placeholders.properties</li>
              <li data-jstree='{"icon":"fas fa-file"}'>RoleDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>RoleServerPermissionDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>ServerPermissionDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>UserDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>UserRoleDao.xml</li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    projectwiki-ws
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            com
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              ontimize
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                projectwiki
                <ul>
                  <li data-jstree='{"icon":"fas fa-folder-open"}'>
                  ws
                  <ul>
                    <li data-jstree='{"icon":"fas fa-folder-open"}'>
                    core
                    <ul>
                      <li data-jstree='{"icon":"fas fa-folder-open"}'>
                      rest
                      <ul>
                        <li data-jstree='{"icon":"fas fa-file"}'>CandidateRestController.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>MainRestController.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>TestRestController.java</li>
                        <li data-jstree='{"icon":"fas fa-file"}'>UserRestController.java</li>
                      </ul>
                      </li>
                    </ul>
                    </li>
                  </ul>
                  </li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    <li data-jstree='{"icon":"fas fa-file"}'>README.md</li>
  </ul>
  </li>
</ul>
</div>
<div class="multiColumn multiColumnGrow">
  <p><strong>ServerApplication.java</strong></p>



<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.ontimize.projectwiki</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.EnableAspectJAutoProxy</span><span class="o">;</span>


<span class="nd">@SpringBootApplication</span>
<span class="nd">@EnableAspectJAutoProxy</span><span class="o">(</span><span class="n">proxyTargetClass</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ServerApplication</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">ServerApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
	<span class="o">}</span>

<span class="o">}</span></code></pre></figure>



  <p><strong>CustomerService.java</strong></p>



<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.ontimize.projectwiki.model.core.service</span><span class="o">;</span>

<span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.access.annotation.Secured</span><span class="o">;</span>


<span class="o">.</span> <span class="o">.</span> <span class="o">.</span> 
<span class="kn">import</span> <span class="nn">com.ontimize.jee.common.security.PermissionsProviderSecured</span><span class="o">;</span>

<span class="o">.</span> <span class="o">.</span> <span class="o">.</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CandidateService</span> <span class="kd">implements</span> <span class="nc">ICandidateService</span> <span class="o">{</span>

<span class="o">.</span> <span class="o">.</span> <span class="o">.</span>

	<span class="nd">@Override</span>
	<span class="nd">@Secured</span><span class="o">({</span> <span class="nc">PermissionsProviderSecured</span><span class="o">.</span><span class="na">SECURED</span> <span class="o">})</span>
	<span class="kd">public</span> <span class="nc">EntityResult</span> <span class="nf">candidateQuery</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">keyMap</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">attrList</span><span class="o">)</span>
			<span class="kd">throws</span> <span class="nc">OntimizeJEERuntimeException</span> <span class="o">{</span>
		<span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">daoHelper</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">candidateDao</span><span class="o">,</span> <span class="n">keyMap</span><span class="o">,</span> <span class="n">attrList</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="nd">@Secured</span><span class="o">({</span> <span class="nc">PermissionsProviderSecured</span><span class="o">.</span><span class="na">SECURED</span> <span class="o">})</span>
	<span class="nd">@Transactional</span><span class="o">(</span><span class="n">rollbackFor</span> <span class="o">=</span> <span class="nc">Exception</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
	<span class="kd">public</span> <span class="nc">EntityResult</span> <span class="nf">candidateInsert</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">attrMap</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">OntimizeJEERuntimeException</span> <span class="o">{</span>
		<span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">daoHelper</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">candidateDao</span><span class="o">,</span> <span class="n">attrMap</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="nd">@Secured</span><span class="o">({</span> <span class="nc">PermissionsProviderSecured</span><span class="o">.</span><span class="na">SECURED</span> <span class="o">})</span>
	<span class="nd">@Transactional</span><span class="o">(</span><span class="n">rollbackFor</span> <span class="o">=</span> <span class="nc">Exception</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
	<span class="kd">public</span> <span class="nc">EntityResult</span> <span class="nf">candidateUpdate</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">attrMap</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">keyMap</span><span class="o">)</span>
			<span class="kd">throws</span> <span class="nc">OntimizeJEERuntimeException</span> <span class="o">{</span>
		<span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">daoHelper</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">candidateDao</span><span class="o">,</span> <span class="n">attrMap</span><span class="o">,</span> <span class="n">keyMap</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="nd">@Secured</span><span class="o">({</span> <span class="nc">PermissionsProviderSecured</span><span class="o">.</span><span class="na">SECURED</span> <span class="o">})</span>
	<span class="kd">public</span> <span class="nc">EntityResult</span> <span class="nf">candidateDelete</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">keyMap</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">OntimizeJEERuntimeException</span> <span class="o">{</span>
		<span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">daoHelper</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">candidateDao</span><span class="o">,</span> <span class="n">keyMap</span><span class="o">);</span>
	<span class="o">}</span>
	
<span class="o">}</span></code></pre></figure>


</div>
</div>

<h2 id="add-permissions-for-methods">Add permissions for methods</h2>

<p>Once the methods have been noted, it is necessary to add the service and the method that we have noted to the table of the DB that stores those elements and to the table that indicates the methods for which the role has permission.</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TSERVER_PERMISSION</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'com.ontimize.projectwiki.model.core.service.CandidateService/candidateQuery'</span><span class="p">)</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TSERVER_PERMISSION</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'com.ontimize.projectwiki.model.core.service.CandidateService/candidateInsert'</span><span class="p">)</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TSERVER_PERMISSION</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'com.ontimize.projectwiki.model.core.service.CandidateService/candidateUpdate'</span><span class="p">)</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TSERVER_PERMISSION</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'com.ontimize.projectwiki.model.core.service.CandidateService/candidateDelete'</span><span class="p">)</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TROLE_SERVER_PERMISSION</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TROLE_SERVER_PERMISSION</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TROLE_SERVER_PERMISSION</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">TROLE_SERVER_PERMISSION</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span></code></pre></figure>

<p>If we try to make requests through <a href="https://www.postman.com/" target="_blank" rel="noopener noreferrer">Postman</a> to the service of CandidateService, changing the authentication by the user candidate and password candidate, it will give an error, since the user candidate does not belong to the role admin which is the only role that has permissions to make these queries.</p>

        
      </section>

      <footer class="page__meta">
        
        


        

      </footer>

      

      
    </div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/imatiainnova" rel="noopener noreferrer" target="_blank"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/company/imatia-innovation/" rel="noopener noreferrer" target="_blank"><i class="fab fa-fw fa-linkedin-in" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://github.com/ontimize/ontimize-boot" rel="noopener noreferrer" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    <li><a href="/ontimize-boot/v1/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">Â© 2021 Imatia Innovation, S.L. Powered by <a href="https://jekyllrb.com" rel="noopener noreferrer" target="_blank">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="noopener noreferrer" target="_blank">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/ontimize-boot/v1/assets/js/main.min.js"></script>











  </body>
</html>
